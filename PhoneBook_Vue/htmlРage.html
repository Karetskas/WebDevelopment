<!DOCTYPE html>
<html lang="en">
<head>
    <title>Phone book</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <link href="node_modules/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="styleSheet.css" rel="stylesheet" />
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.js" defer></script>
    <script src="node_modules/underscore/underscore.js" defer></script>
    <script src="node_modules/vue/dist/vue.js" defer></script>
    <script src="javaScript.js" defer></script>
</head>
<body class="p-1">
    <div id="app">
        <transition name="modalDialog">
            <template v-if="isModalDialogVisible">
                <div class="modal d-inline-block">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <div class="h1 fs-4">Delete these contact(s) from the phone book?</div>
                            </div>
                            <div class="modal-body">
                                <ul class="list-group"
                                    v-for="(contact, index) in contactsToDelete"
                                    :key="index">
                                    <li class="list-group-item text-break">
                                        <div>
                                            Last name: <span v-text="contact.lastName"></span>
                                        </div>
                                        <div>
                                            First name: <span v-text="contact.firstName"></span>
                                        </div>
                                        <div>
                                            Phone number: <span v-text="contact.phoneNumber"></span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div class="modal-footer">
                                <div class="btn-group w-100" role="group">
                                    <template v-if="singleContactIndex >= 0">
                                        <button type="button"
                                                class="pb-2 px-2 btn btn-primary rounded-0 rounded-start"
                                                name="delete_rows"
                                                @click="deleteContact(singleContactIndex)">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                 width="24"
                                                 height="24"
                                                 fill="currentColor"
                                                 class="bi bi-person-dash"
                                                 viewBox="0 0 16 16">
                                                <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7ZM11 12h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Zm0-7a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                                                <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z" />
                                            </svg>
                                            delete
                                        </button>
                                    </template>

                                    <template v-else>
                                        <button type="button"
                                                class="pb-2 px-2 btn btn-primary rounded-0 rounded-start"
                                                name="delete_rows"
                                                @click="deleteContacts">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                 width="24"
                                                 height="24"
                                                 fill="currentColor"
                                                 class="bi bi-person-check"
                                                 viewBox="0 0 16 16">
                                                <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514ZM11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                                                <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z" />
                                            </svg>
                                            delete
                                        </button>
                                    </template>

                                    <button type="button"
                                            class="pb-2 px-2 btn btn-secondary rounded-0 rounded-end"
                                            name="cancel"
                                            @click="isModalDialogVisible = false">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                             width="22"
                                             height="22"
                                             fill="currentColor"
                                             class="bi bi-x-square"
                                             viewBox="0 0 16 16">
                                            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                                        </svg>
                                        cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </transition>

        <div class="h1 text-decoration-underline text-center">Phone book</div>

        <div class="container-md d-flex flex-column mb-3 align-items-center p-3 rounded-5 bg-secondary bg-opacity-25 border border-3 border-secondary">
            <div class="h2 col-12 col-sm-10 col-md-8">Add new contact:</div>

            <div class="col-12 col-sm-10 col-md-8">
                <label>First name:</label>
                <div class="mb-2 d-flex flex-column align-items-center">
                    <input class="form-control px-2 rounded-3 w-100 border border-1 border-secondary"
                           :class="textBoxClassesFirstName"
                           type="text"
                           name="first_name"
                           placeholder="enter first name..."
                           tabindex="1"
                           ref="firstName"
                           v-model="firstNameText" />
                    <div class="text-center fst-italic"
                         :class="errorMessageClassesFirstName"
                         v-cloak
                         v-html="errorMessageFirstName.messages"></div>
                </div>

                <label>Last name:</label>
                <div class="mb-2 d-flex flex-column align-items-center">
                    <input class="form-control px-2 rounded-3 w-100 border border-1 border-secondary"
                           :class="textBoxClassesLastName"
                           type="text"
                           name="last_name"
                           placeholder="enter last name..."
                           tabindex="2"
                           v-model="lastNameText" />
                    <div class="text-center fst-italic"
                         :class="errorMessageClassesLastName"
                         v-cloak
                         v-html="errorMessageLastName.messages"></div>
                </div>

                <label>Phone number:</label>
                <div class="mb-3 d-flex flex-column align-items-center">
                    <input class="form-control px-2 rounded-3 w-100 border border-1 border-secondary"
                           :class="textBoxClassesPhoneNumber"
                           type="tel"
                           name="phone_number"
                           placeholder="enter phone number..."
                           tabindex="3"
                           v-model="phoneNumberText" />
                    <div class="text-center fst-italic"
                         :class="errorMessageClassesPhoneNumber"
                         v-cloak
                         v-html="errorMessagePhoneNumber.messages"></div>
                </div>

                <div class="d-flex justify-content-center">
                    <button class=" btn btn-success rounded-3"
                            type="button"
                            name="add_new_contact"
                            tabindex="4"
                            :disabled="areValidContactFields"
                            @click="addContact">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="24"
                             height="24"
                             fill="currentColor"
                             class="bi bi-person-add"
                             viewBox="0 0 16 16">
                            <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                            <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z" />
                        </svg>
                        Add contact
                    </button>
                </div>
            </div>
        </div>

        <div class="d-flex px-0 mb-2">
            <button type="button"
                    class="me-1 pb-2 btn btn-danger rounded-3 position-relative"
                    title="Delete selected rows with phone numbers"
                    :disabled="deleteSelectedRowsButton.isDisabled"
                    @click="showModalDialog()">
                <svg xmlns="http://www.w3.org/2000/svg"
                     width="22" height="22"
                     fill="currentColor"
                     class="bi bi-trash"
                     viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                    <path fill-rule="evenodd"
                          d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                </svg>
                <span class="position-absolute py-0 top-0 start-50 translate-middle badge rounded-pill bg-dark"
                      v-text="selectedRowsCount">
                </span>
            </button>

            <div class="btn-group w-100" role="group">
                <input class="form-control border border-secondary rounded-0 rounded-start"
                       type="text"
                       name="filter"
                       placeholder="search filter..."
                       v-model.trim="textToFilter" />

                <button type="button"
                        class="pb-2 px-2 btn btn-primary rounded-0"
                        name="apply_filter"
                        title="Apply filter"
                        @click="filterContacts()">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="22"
                         height="22"
                         fill="currentColor"
                         class="bi bi-funnel"
                         viewBox="0 0 16 16">
                        <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z" />
                    </svg>
                </button>

                <button type="button"
                        class="pb-2 px-2 btn btn-secondary rounded-0 rounded-end"
                        name="filter_reset"
                        title="Reset filter"
                        @click="resetFilter">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="22"
                         height="22"
                         fill="currentColor"
                         class="bi bi-x-square"
                         viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                    </svg>
                </button>
            </div>
        </div>

        <table class="table table-hover">
            <thead class="align-middle table-secondary">
                <tr>
                    <th class="p-1 text-center" scope="col">
                        <input class="form-check-input"
                               type="checkbox"
                               name="mark_subscriber"
                               title="Select or deselect all rows"
                               :disabled="generalCheckBox.isDisabled"
                               :checked="generalCheckBox.isChecked"
                               @change="changeAllCheckBoxes" />
                    </th>
                    <th class="p-1" scope="col">#</th>
                    <th class="p-1" scope="col">Last name</th>
                    <th class="p-1" scope="col">First name</th>
                    <th class="p-1" scope="col">Phone number</th>
                    <th class="p-0 col-2" scope="col"></th>
                </tr>
            </thead>
            <tbody class="align-middle table-group-divider" name="list" is="transition-group">
                <template v-if="isPhoneBookEmpty">
                    <tr>
                        <td colspan="6">
                            <div class="fs-4 text-danger text-center">
                                <i class="bi bi-exclamation-triangle"></i> Phone book is empty! <i class="bi bi-exclamation-triangle"></i>
                            </div>
                        </td>
                    </tr>
                </template>

                <template v-if="contactsNotFound">
                    <tr>
                        <td colspan="6">
                            <div class="fs-4 text-danger text-center">
                                <i class="bi bi-emoji-frown"></i> Nothing found! <i class="bi bi-emoji-frown"></i>
                            </div>
                        </td>
                    </tr>
                </template>

                <tr v-for="(contact, index) in contacts"
                    :key="contact.id"
                    :class="{'d-none': !contact.isVisible, 'd-table-row': contact.isVisible}">
                    <template v-if="contact.isVisible">
                        <td class="p-1 text-center">
                            <input class="form-check-input"
                                   type="checkbox"
                                   name="mark_subscriber"
                                   title="Select or deselect this row"
                                   :checked="contact.isChecked"
                                   @change="changeOneCheckBox(contact)" />
                        </td>
                        <th class="p-1"
                            scope="row"
                            v-text="index + 1"></th>
                        <td class="p-1 text-break"
                            v-text="contact.lastName"></td>
                        <td class="p-1 text-break"
                            v-text="contact.firstName"></td>
                        <td class="p-1 text-break"
                            v-text="contact.phoneNumber"></td>
                        <td class="p-0 text-center position-relative">
                            <button type="button"
                                    class="position-absolute top-0 bottom-0 start-0 end-0 w-100 px-1 pt-0 btn btn-danger rounded-0"
                                    title="Delete this row"
                                    @click="showModalDialog(index)">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="22"
                                     height="22"
                                     fill="currentColor"
                                     class="bi bi-telephone-x"
                                     viewBox="0 0 16 16">
                                    <path d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122l-2.19.547a1.745 1.745 0 0 1-1.657-.459L5.482 8.062a1.745 1.745 0 0 1-.46-1.657l.548-2.19a.678.678 0 0 0-.122-.58L3.654 1.328zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z" />
                                    <path fill-rule="evenodd"
                                          d="M11.146 1.646a.5.5 0 0 1 .708 0L13 2.793l1.146-1.147a.5.5 0 0 1 .708.708L13.707 3.5l1.147 1.146a.5.5 0 0 1-.708.708L13 4.207l-1.146 1.147a.5.5 0 0 1-.708-.708L12.293 3.5l-1.147-1.146a.5.5 0 0 1 0-.708z" />
                                </svg>
                            </button>
                        </td>
                    </template>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>